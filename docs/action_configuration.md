# 动作配置系统说明

## 系统概述

动作配置系统允许用户通过图形化界面创建和管理机器人动作序列。系统支持多种基本动作类型,并可以通过组合形成复杂的动作序列。

## 动作类型

### 1. 移动动作(MovementAction)
- 功能：控制机器人的基本运动
- 参数：
  - 线速度 (m/s)
  - 角速度 (rad/s) 
  - 持续时间 (s)
- 工作原理：
  - 设置目标速度
  - 启动定时器
  - 到达指定时间后停止

### 2. 导航动作(NavigationAction)
- 功能：控制机器人导航到指定位置
- 参数：
  - 目标位置 X (m)
  - 目标位置 Y (m)
  - 目标朝向 θ (rad)
  - 到达容差 (m)
- 工作原理：
  - 设置导航目标点
  - 调用move_base进行路径规划
  - 执行导航任务
  - 监控导航状态

### 3. 循环动作(LoopAction)
- 功能：重复执行指定的子动作
- 参数：
  - 循环次数
  - 子动作
- 工作原理：
  - 记录当前循环次数
  - 重复执行子动作
  - 达到指定次数后停止

### 4. 条件动作(ConditionAction)
- 功能：根据条件执行不同的动作分支
- 参数：
  - 条件类型
  - 条件参数
  - 真分支动作
  - 假分支动作
- 工作原理：
  - 评估条件
  - 根据条件结果选择执行分支
  - 监控执行状态

### 5. 延时动作(DelayAction)
- 功能：等待指定时间
- 参数：
  - 延时时间 (s)
- 工作原理：
  - 启动定时器
  - 等待指定时间
  - 超时后继续执行

### 6. 路径动作(PathAction)
- 功能：控制机器人沿预定义路径运动
- 参数：
  - 路径点列表
  - 到达容差
  - 是否循环
- 工作原理：
  - 加载路径点
  - 逐点导航
  - 监控执行进度

## 动作编辑器

### 1. 界面组成
```
+------------------------+
|     工具栏             |
+------------------------+
|        |              |
| 动作   |   编辑区      |
| 列表   |              |
|        |              |
+------------------------+
|     属性编辑器         |
+------------------------+
```

### 2. 操作说明
- 添加动作：从动作列表拖拽到编辑区
- 连接动作：通过连接线连接动作块
- 编辑参数：在属性编辑器中设置
- 保存/加载：支持序列化到文件

### 3. 动作序列管理
- 序列验证
- 执行控制
- 状态监控
- 错误处理

## 执行机制

### 1. 执行流程
```
动作加载 -> 参数验证 -> 开始执行 -> 状态监控 -> 完成/错误处理
```

### 2. 状态转换
```
初始状态 -> 准备就绪 -> 执行中 -> 已完成/已停止/出错
```

### 3. 错误处理
- 参数验证错误
- 执行超时
- 硬件错误
- 安全限制

## 扩展开发

### 1. 添加新动作类型
1. 继承ActionBlock基类
2. 实现必要的虚函数
3. 在工厂类中注册
4. 添加界面支持

### 2. 自定义条件
1. 实现条件评估接口
2. 注册到条件系统
3. 添加参数配置

### 3. 序列化支持
1. 实现序列化接口
2. 添加版本兼容性
3. 处理数据迁移 